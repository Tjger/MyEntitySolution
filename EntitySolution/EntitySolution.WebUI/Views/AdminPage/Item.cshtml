
@{
    ViewBag.Title = "Item";
    Layout = "~/Views/Shared/_LayoutBackEnd.cshtml";
}

<h2>Sản Phẩm</h2>
<script>
    var isAddNewCategory = false;
    $(document).ready(function () {
        //LoadAllCategory();


        $("#categoryActive").bootstrapSwitch();


        $("#btnAddNew").click(function () {
            isAddNewCategory = true;
            $("#categoryID").val("-1");
            $("#categoryName").val("");
            $("#categoryName2").val("");
            $('#categoryActive').bootstrapSwitch('state', true);
            $("#modalCategoryInformation").modal("show");
        });

        $("#btnCategoryModalSave").click(function (e) {
            e.preventDefault();
            SaveCategory();
        });
        $("#btnConfirmDelete").click(function (e) {
            e.preventDefault();
            DeleteCategory();
        });

    });// end of document ready

    function SaveCategory() {
        var cActive = "0";
        var state = $('#categoryActive').bootstrapSwitch('state');

        if ($('#categoryActive').bootstrapSwitch('state')) {
            cActive = "1";
        }

        var categoryInfor = {
            CategoryID: $("#categoryID").val(),
            CategoryName: $("#categoryName").val(),
            Active: cActive,
            CategoryName2: $("#categoryName2").val(),
        }

        if (isAddNewCategory) {
            $.ajax({
                url: '@Url.Action("SaveCategory", "AdminPage")',

                type: 'POST',
                dataType: "json",
                data: categoryInfor,
                success: function (data) {

                    if (data.success === true) {
                        isAddNewCategory = false;
                        FillDataToGridTableHtml(data.returnList);
                    }


                }
            });
        }
        else {
            $.ajax({
                url: '@Url.Action("EditCategory", "AdminPage")',

                type: 'POST',
                dataType: "json",
                data: categoryInfor,
                success: function (data) {

                    if (data.success === true) {
                        isAddNewCategory = false;
                        FillDataToGridTableHtml(data.returnList);
                    }


                }
            });
        }

    };

    function DeleteCategory() {
        var deleteCategoryID = $("#deleteCategoryID").val();
        $.ajax({
            url: '@Url.Action("DeleteCategory", "AdminPage")',
            contentType: "application/json; charset=utf-8",
            type: 'POST',
            dataType: "json",
            data:  JSON.stringify( { "deleteCategoryID":$("#deleteCategoryID").val() } ) ,
            success: function (data) {
                if (data.success === true) {

                    FillDataToGridTableHtml(data.returnList);
                }
                else {
                    $("#lblMessageModal").html("Trước khi xóa nhóm sản phẩm này, hãy xóa hết các sản phẩm nằm trong nó.");

                    $("#modalShowError").modal("show");
                }
            }
        });
    };

    function LoadAllCategory() {
        $.ajax({
            url: '@Url.Action("LoadAllCategory", "AdminPage")',
            contentType: "application/json; charset=utf-8",
            type: 'GET',
            dataType: "json",
            data: {},
            success: function (data) {


                FillDataToGridTableHtml(data.returnList);
            }
        });
    };

    function ShowDeleteCategory(sCategoryID) {
        $("#deleteCategoryID").val(sCategoryID);

        $("#modalConfirmDeleteCategory").modal("show");
    };

    function ShowEditCategory(sCategoryID, sCategoryName, sCategoryName2, sCategoryActive) {
        isAddNewCategory = false;
        $("#categoryID").val(sCategoryID);
        $("#categoryName").val(sCategoryName);
        $("#categoryName2").val(sCategoryName2);
        if (sCategoryActive == "1") {
            $('#categoryActive').bootstrapSwitch('state', true);
        }
        else {
            $('#categoryActive').bootstrapSwitch('state', false);

        };
        $("#modalCategoryInformation").modal("show");
    };

    function InitGridTableHtml() {

        var gridTableHtml = "<table cellspacing=\"0\" cellpadding=\"4\" style=\"color:#333333;border-collapse:collapse;\"  class=\"table\"> ";
        gridTableHtml += "<tbody> <tr style=\"color:White;background-color:#428BCA;font-weight:bold;\">";
        gridTableHtml += "<th scope=\"col\">ID</th>";
        gridTableHtml += "<th scope=\"col\">Tên</th>";
        gridTableHtml += "<th scope=\"col\">Tên 2</th>";
        gridTableHtml += "<th scope=\"col\">Trạng Thái</th>";
        gridTableHtml += "<th scope=\"col\">&nbsp;</th>";
        gridTableHtml += "<th scope=\"col\">&nbsp;</th>";
        gridTableHtml += " </tr>";
        return gridTableHtml;
    };

    function FillDataToGridTableHtml(listData) {


        $("#ContentPlaceHolder").html("");
        var gridTableHtml = InitGridTableHtml();

        $.each(listData, function (index, item) {

            gridTableHtml += "<tr>";
            gridTableHtml += "<td>" + item.CategoryID + "</td>";
            gridTableHtml += "<td>" + item.CategoryName + "</td>";
            gridTableHtml += "<td>" + item.CategoryName2 + "</td>";
            gridTableHtml += "<td>"
            if (item.Active == "1") {
                gridTableHtml += "On</td>";
            }
            else {
                gridTableHtml += "Off</td>";
            }
            gridTableHtml += "<td style=\"width:60px;\"><a style=\"color:#333333;\" onclick=\"ShowEditCategory('" + item.CategoryID + "','" + item.CategoryName + "','" + item.CategoryName2 + "','" + item.Active + "')\">Edit</a></td>";
            gridTableHtml += "<td style=\"width:60px;\"><a style=\"color:red;\" onclick=\"ShowDeleteCategory('" + item.CategoryID + "')\">Delete</a></td>";
            gridTableHtml += " </tr>";
        });

        gridTableHtml += "</tbody></table>";

        $("#ContentPlaceHolder").html(gridTableHtml);
    };
</script>

<form id="form1" action="" method="post">
    <table class="table" cellspacing="0" cellpadding="4" id="ContentPlaceHolder1_ctl00_GridView1" style="color:#333333;border-collapse:collapse;">
        <tbody>
            <tr style="color:White;background-color:#428BCA;font-weight:bold;">
                <th scope="col">ID</th>
                <th scope="col">Image</th>
                <th scope="col">Name</th>
                <th scope="col">Active</th>
                <th scope="col">Hot</th>
                <th scope="col">Price</th>
                <th scope="col">Xuất xứ</th>
                <th scope="col">Key Search</th>
                <th scope="col">&nbsp;</th>
                <th scope="col">&nbsp;</th>
            </tr>
            <tr>
                <td>14</td>
                <td><img src="UpLoad/Images/Kuangtai.jpg" style="height:30px;width:30px;"></td>
                <td>kuangtai que hàn </td>
                <td><span class="aspNetDisabled"><input id="ContentPlaceHolder1_ctl00_GridView1_ctl02_0" type="checkbox" name="ctl00$ContentPlaceHolder1$ctl00$GridView1$ctl02$ctl02" checked="checked" disabled="disabled"></span></td>
                <td><span class="aspNetDisabled"><input id="ContentPlaceHolder1_ctl00_GridView1_ctl03_0" type="checkbox" name="ctl00$ContentPlaceHolder1$ctl00$GridView1$ctl02$ctl03" disabled="disabled"></span></td>
                <td>NA</td>
                <td>Taiwan</td>
                <td>KT-401 E6019	E4301	- KT-403 -	E4303	E350RB KT-410 E6010 E4310	E350C KT-411 E6011	E4311	E353C KT-413 E6013	E4313 E35ZR KT-413V E6013	E4313	E35ZR KT-26 -	E4340	- KT-7 -	E4303 E350RB KT-42 -	E4303	E350RB/kuangtai</td>
                <td><a href="Admin.aspx?module=6&amp;m=1&amp;Id=14">View Detail</a></td>
                <td style="width:60px;"><a onclick="return confirm('Do you want to delete?');" href="javascript:__doPostBack('ctl00$ContentPlaceHolder1$ctl00$GridView1','Delete$0')" style="color:#333333;">Delete</a></td>
            </tr>
     
            <tr class="gridview">
                <td colspan="10">
                    <table>
                        <tbody>
                            <tr>
                                <td><span>1</span></td>
                                <td><a href="javascript:__doPostBack('ctl00$ContentPlaceHolder1$ctl00$GridView1','Page$2')" style="color:#333333;">2</a></td>
                                <td><a href="javascript:__doPostBack('ctl00$ContentPlaceHolder1$ctl00$GridView1','Page$3')" style="color:#333333;">3</a></td>
                                <td><a href="javascript:__doPostBack('ctl00$ContentPlaceHolder1$ctl00$GridView1','Page$4')" style="color:#333333;">4</a></td>
                                <td><a href="javascript:__doPostBack('ctl00$ContentPlaceHolder1$ctl00$GridView1','Page$5')" style="color:#333333;">5</a></td>
                                <td><a href="javascript:__doPostBack('ctl00$ContentPlaceHolder1$ctl00$GridView1','Page$6')" style="color:#333333;">6</a></td>
                                <td><a href="javascript:__doPostBack('ctl00$ContentPlaceHolder1$ctl00$GridView1','Page$7')" style="color:#333333;">7</a></td>
                                <td><a href="javascript:__doPostBack('ctl00$ContentPlaceHolder1$ctl00$GridView1','Page$8')" style="color:#333333;">8</a></td>
                                <td><a href="javascript:__doPostBack('ctl00$ContentPlaceHolder1$ctl00$GridView1','Page$9')" style="color:#333333;">9</a></td>
                                <td><a href="javascript:__doPostBack('ctl00$ContentPlaceHolder1$ctl00$GridView1','Page$10')" style="color:#333333;">10</a></td>
                                <td><a href="javascript:__doPostBack('ctl00$ContentPlaceHolder1$ctl00$GridView1','Page$11')" style="color:#333333;">...</a></td>
                            </tr>
                        </tbody>
                    </table>
                </td>
            </tr>
        </tbody>
    </table>
</form>